
# library that handles the URL stuff 

import urllib.request 
from nameparser import HumanName
import pandas as pd
import smtplib

# Importing module required for 
# regular expressions 

import re 



  
# Assign urlopen to a file object variable 

fhand = urllib.request.urlopen ('https://www.chamber.nyc/directory.php?l=a') 

a = 0
b = ""
c = ""

for line in fhand: 

    # Getting the text file 

    # content line by line. 

    s = line.decode().strip() 

  

    # regex for extracting all email-ids 

    # from the text file 

    reg = re.findall(r"[A-Za-z0-9._%+-]+"

                     r"@[A-Za-z0-9.-]+"

                     r"\.[A-Za-z]{2,4}", s)
    
    element = reg[a]
    a++
    
    
    b = HumanName(s).first
    c = HumanName(s).last
    first_last = b + " " + c
    
    
    def send_email(sendto, subject, text):
    username = "omarguaba54@gmail.com" # Change this!
    password = "Esculapio01" # Change this!
    for i in range(3):
        try:
            print("Sending Email to {} (trial {})...".format(sendto, i+1))
            server = smtplib.SMTP('smtp.gmail.com', 587)
            server.starttls()
            server.login(username, password)
            msg = 'Subject: {}\n\n{}'.format(subject, text)
            server.sendmail(username, sendto, msg)
            server.quit()
            print("Email sent!")
            break
        except Exception as e:
            print("Failed to send email due to Exception:")
            print(e)
            
    send_email(element,"How to Get More Clients","""\

Hi {},

My name is Omar Guaba. I am SEO expert who is offering my services to people like you to make them generate more sales.

Please check it out:
https://www.upwork.com/services/product/a-fabulous-seo-service-1421195933987880960

Looking forward to hearing from you,


Omar Guaba 
""".format(first_last))
               
  

    # printing the list output 

    print(reg)
    
